<header class="fixed top-0 left-0 right-0 z-50" [attr.dir]="currentLang() === 'ar' ? 'rtl' : 'ltr'">
  <!-- Header principal -->
  <div [ngClass]="mainHeaderClasses()" class="transition-all duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center">

        <!-- Logo -->
        <a routerLink="/" class="flex items-center space-x-3 rtl:space-x-reverse">
          <img src="assets/images/sned.svg" alt="sned_logo" class="h-16 sm:h-20 w-auto"/>
        </a>

        <!-- Menu + Sélecteur langues -->
        <div class="flex items-center space-x-6 rtl:space-x-reverse">

          <!-- Menu Desktop -->
          <nav class="hidden lg:flex items-center space-x-6 rtl:space-x-reverse">
            <div *ngFor="let section of menuSections" class="flex space-x-6 rtl:space-x-reverse">

              <div *ngFor="let item of section.items" class="relative group">

                <!-- Item simple -->
                <a *ngIf="!item.children"
                   [routerLink]="item.route || '/'"
                   routerLinkActive="active-link"
                   [routerLinkActiveOptions]="{ exact: true }"
                   (click)="closeMobileMenu()"
                   class="relative px-4 py-2 font-medium rounded-lg inline-flex items-center transition group text-[var(--sned-orange-dark)]">
                  {{ item.label }}

                  <!-- Trait animé -->
                  <span class="absolute left-0 right-0 -bottom-1 h-[3px] bg-[var(--sned-blue)]
                         scale-x-0 group-hover:scale-x-100 transition-transform duration-300
                         group-[.active-link]:scale-x-100"></span>
                </a>

                <!-- Item avec dropdown -->
                <div *ngIf="item.children" class="relative group">
                  <button  [routerLink]="item.route || '/'" class="cursor-pointer relative px-4 py-2 font-medium rounded-lg inline-flex items-center gap-1 transition group text-[var(--sned-orange-dark)]"
                          routerLinkActive="active-link">
                    {{ item.label }}
                    <span class="text-xs">▼</span>

                    <!-- Trait animé -->
                    <span class="absolute left-0 right-0 -bottom-1 h-[3px] bg-[var(--sned-orange)]
                           scale-x-0 group-hover:scale-x-100 transition-transform duration-300
                           group-[.active-link]:scale-x-100"></span>
                  </button>

                  <!-- Sous-menu -->
                  <div class="absolute left-0 rtl:right-0 rtl:left-auto mt-2 min-w-[220px] bg-white rounded-lg shadow-lg border border-gray-100
                              opacity-0 invisible group-hover:opacity-100 group-hover:visible
                              transition duration-200 ease-out z-50">
                    <a *ngFor="let child of item.children"
                       [routerLink]="child.route || '/'"
                       routerLinkActive="active-link"
                       [routerLinkActiveOptions]="{ exact: true }"
                       (click)="closeMobileMenu()"
                       class="block px-4 py-2 text-[var(--sned-orange-dark)] hover:bg-[var(--sned-orange-light)]/10 whitespace-nowrap rtl:text-right">
                      {{ child.label }}
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </nav>

          <div class="relative"
               (mouseenter)="toggleLangDropdown(true)"
               (mouseleave)="toggleLangDropdown(false)">

            <!-- Langue active -->
            <div class="relative group">
              <button class="cursor-pointer p-1 rounded-full shadow-md bg-white flex items-center justify-center hover:ring-2 hover:ring-[var(--sned-orange)] transition">
                <img [src]="currentLangData().flag"
                     [alt]="currentLangData().label"
                     class="w-8 h-8 rounded-full"/>
              </button>
              <!-- Tooltip langue active -->
              <span
                class="absolute right-full mr-3 top-1/2 -translate-y-1/2 px-2 py-1 text-sm rounded-md bg-gray-800 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap">
      {{ currentLangData().label }}
    </span>
            </div>

            <!-- Zone de tolérance (invisible) -->
            <div class="absolute top-full right-0 w-12 h-3"></div>

            <!-- Autres langues -->
            <div
              class="absolute top-[calc(100%+0.5rem)] right-0 flex flex-col space-y-2 z-50 transform transition-all duration-300 ease-out"
              [ngClass]="{
      'opacity-100 translate-y-0 pointer-events-auto': showLangDropdown(),
      'opacity-0 -translate-y-2 pointer-events-none': !showLangDropdown()
    }">

              <ng-container *ngFor="let lang of languages">
                <div *ngIf="lang.code !== currentLang()" class="relative group">
                  <button
                    (click)="switchLanguage(lang.code)"
                    class="cursor-pointer p-1 rounded-full shadow-md bg-white hover:bg-[var(--sned-orange-light)] flex items-center justify-center transition">
                    <img [src]="lang.flag"
                         [alt]="lang.label"
                         class="w-8 h-8 rounded-full"/>
                  </button>
                  <!-- Tooltip langues secondaires -->
                  <span
                    class="absolute right-full mr-3 top-1/2 -translate-y-1/2 px-2 py-1 text-sm rounded-md bg-gray-800 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap">
          {{ lang.label }}
        </span>
                </div>
              </ng-container>
            </div>
          </div>






        </div>

        <!-- Bouton Mobile -->
        <div class="lg:hidden">
          <button (click)="toggleMobileMenu()"
                  class="p-2 rounded-md text-[var(--sned-blue-dark)] hover:bg-[var(--sned-orange-light)]/20 focus:outline-none">
            <!-- Icône burger -->
            <svg *ngIf="!isMobileMenuOpen()" class="w-6 h-6" fill="none" stroke="currentColor"
                 viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
            <!-- Icône close -->
            <svg *ngIf="isMobileMenuOpen()" class="w-6 h-6" fill="none" stroke="currentColor"
                 viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Menu Mobile -->
  <div *ngIf="isMobileMenuOpen()" class="lg:hidden absolute top-full left-0 w-full bg-white shadow-md z-40">
    <div class="flex flex-col divide-y divide-gray-200">
      <ng-container *ngFor="let section of menuSections">
        <ng-container *ngFor="let item of section.items">
          <!-- Simple -->
          <a *ngIf="!item.children"
             [routerLink]="item.route || '/'"
             (click)="closeMobileMenu()"
             class="px-4 py-3 font-medium text-[var(--sned-blue-dark)] hover:bg-[var(--sned-orange-light)]/30">
            {{ item.label }}
          </a>

          <!-- Dropdown -->
          <div *ngIf="item.children" class="flex flex-col">
            <button (click)="toggleMobileDropdown(item.label)"
                    class="px-4 py-3 flex justify-between items-center font-medium text-[var(--sned-blue-dark)] hover:bg-[var(--sned-orange-light)]/20">
              {{ item.label }}
              <span [ngClass]="{'rotate-180': isMobileDropdownOpen(item.label)}"
                    class="transition-transform text-sm">▼</span>
            </button>
            <div *ngIf="isMobileDropdownOpen(item.label)" class="flex flex-col">
              <a *ngFor="let child of item.children"
                 [routerLink]="child.route || '/'"
                 (click)="closeMobileMenu()"
                 class="px-6 py-2 text-[var(--sned-blue-dark)] hover:bg-[var(--sned-orange-light)]/20">
                {{ child.label }}
              </a>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>
</header>

<!-- HERO Section -->
<section class="relative h-screen text-white flex items-center bg-cover bg-center"
         [style.background-image]="!isVideoPlaying && currentBackground ? 'url(' + currentBackground + ')' : ''">

  <!-- Vidéo -->
  <video *ngIf="isVideoPlaying" autoplay muted loop playsinline
         class="absolute inset-0 w-full h-full object-cover z-0">
    <source src="assets/videos/background.mp4" type="video/mp4"/>
  </video>

  <!-- Overlay -->
  <div class="absolute inset-0 bg-black/50 z-0"></div>

  <!-- Loader si aucune image -->
  <div *ngIf="!isVideoPlaying && !currentBackground"
       class="absolute inset-0 flex items-center justify-center z-10">
    <app-loader></app-loader>
  </div>

  <!-- Texte -->
  <div class="relative z-20 max-w-2xl px-6 sm:px-12 mt-32">
    <h2 class="text-2xl sm:text-4xl font-bold mb-4">Découvrez le projet SNED</h2>
    <p class="mb-6 text-gray-200">Une liaison fixe pour rapprocher les continents</p>
    <button (click)="playVideo()"
            class="cursor-pointer flex items-center gap-2 px-6 py-3 bg-[var(--sned-orange)] text-white font-semibold rounded-full shadow-md hover:bg-[var(--sned-orange-dark)] transition">
      <i class="fas fa-play-circle text-lg"></i>
      <span>Voir la vidéo</span>
    </button>
  </div>
</section>
